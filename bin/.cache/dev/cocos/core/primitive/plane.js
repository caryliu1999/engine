(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../math/index.js", "./define.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../math/index.js"), require("./define.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.index, global.define);
    global.plane = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _index, _define) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.default = plane;

  /**
   * @category 3d/primitive
   */

  /**
   * @zh
   * 应用默认的平面参数选项。
   * @param options 平面参数选项。
   */
  function applyDefaultPlaneOptions(options) {
    options = (0, _define.applyDefaultGeometryOptions)(options);
    options.width = options.width || 10;
    options.length = options.length || 10;
    options.widthSegments = options.widthSegments || 10;
    options.lengthSegments = options.lengthSegments || 10;
    return options;
  }

  var temp1 = new _index.Vec3(0, 0, 0);
  var temp2 = new _index.Vec3(0, 0, 0);
  var temp3 = new _index.Vec3(0, 0, 0);
  var r = new _index.Vec3(0, 0, 0);
  var c00 = new _index.Vec3(0, 0, 0);
  var c10 = new _index.Vec3(0, 0, 0);
  var c01 = new _index.Vec3(0, 0, 0);
  /**
   * @en
   * This function generates a plane on XOZ plane with positive Y direction.
   * @zh
   * 生成一个平面，其位于XOZ平面，方向为Y轴正方向。
   * @param options 平面参数选项。
   */

  function plane(options) {
    var normalizedOptions = applyDefaultPlaneOptions(options);
    var width = normalizedOptions.width,
        length = normalizedOptions.length,
        uSegments = normalizedOptions.widthSegments,
        vSegments = normalizedOptions.lengthSegments;
    var hw = width * 0.5;
    var hl = length * 0.5;
    var positions = [];
    var uvs = [];
    var indices = [];
    var minPos = new _index.Vec3(-hw, 0, -hl);
    var maxPos = new _index.Vec3(hw, 0, hl);
    var boundingRadius = Math.sqrt(width * width + length * length);

    _index.Vec3.set(c00, -hw, 0, hl);

    _index.Vec3.set(c10, hw, 0, hl);

    _index.Vec3.set(c01, -hw, 0, -hl);

    for (var y = 0; y <= vSegments; y++) {
      for (var x = 0; x <= uSegments; x++) {
        var u = x / uSegments;
        var v = y / vSegments;

        _index.Vec3.lerp(temp1, c00, c10, u);

        _index.Vec3.lerp(temp2, c00, c01, v);

        _index.Vec3.subtract(temp3, temp2, c00);

        _index.Vec3.add(r, temp1, temp3);

        positions.push(r.x, r.y, r.z);

        if (normalizedOptions.includeUV) {
          uvs.push(u, v);
        }

        if (x < uSegments && y < vSegments) {
          var useg1 = uSegments + 1;
          var a = x + y * useg1;
          var b = x + (y + 1) * useg1;
          var c = x + 1 + (y + 1) * useg1;
          var d = x + 1 + y * useg1;
          indices.push(a, d, b);
          indices.push(d, c, b);
        }
      }
    }

    var result = {
      positions: positions,
      indices: indices,
      minPos: minPos,
      maxPos: maxPos,
      boundingRadius: boundingRadius
    };

    if (normalizedOptions.includeNormal) {
      var nVertex = (vSegments + 1) * (uSegments + 1);
      var normals = new Array(3 * nVertex);
      result.normals = normals;

      for (var i = 0; i < nVertex; ++i) {
        normals[i * 3 + 0] = 0;
        normals[i * 3 + 1] = 1;
        normals[i * 3 + 2] = 0;
      }
    }

    if (normalizedOptions.includeUV) {
      result.uvs = uvs;
    }

    return result;
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImU6L2QwMDQ1MjUyMC9HaXRodWIvZW5naW5lL2NvY29zL2NvcmUvcHJpbWl0aXZlL3BsYW5lLnRzIl0sIm5hbWVzIjpbImFwcGx5RGVmYXVsdFBsYW5lT3B0aW9ucyIsIm9wdGlvbnMiLCJ3aWR0aCIsImxlbmd0aCIsIndpZHRoU2VnbWVudHMiLCJsZW5ndGhTZWdtZW50cyIsInRlbXAxIiwiVmVjMyIsInRlbXAyIiwidGVtcDMiLCJyIiwiYzAwIiwiYzEwIiwiYzAxIiwicGxhbmUiLCJub3JtYWxpemVkT3B0aW9ucyIsInVTZWdtZW50cyIsInZTZWdtZW50cyIsImh3IiwiaGwiLCJwb3NpdGlvbnMiLCJ1dnMiLCJpbmRpY2VzIiwibWluUG9zIiwibWF4UG9zIiwiYm91bmRpbmdSYWRpdXMiLCJNYXRoIiwic3FydCIsInNldCIsInkiLCJ4IiwidSIsInYiLCJsZXJwIiwic3VidHJhY3QiLCJhZGQiLCJwdXNoIiwieiIsImluY2x1ZGVVViIsInVzZWcxIiwiYSIsImIiLCJjIiwiZCIsInJlc3VsdCIsImluY2x1ZGVOb3JtYWwiLCJuVmVydGV4Iiwibm9ybWFscyIsIkFycmF5IiwiaSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7OztBQW1DQTs7Ozs7QUFLQSxXQUFTQSx3QkFBVCxDQUFtQ0MsT0FBbkMsRUFBNkY7QUFDekZBLElBQUFBLE9BQU8sR0FBRyx5Q0FBMkNBLE9BQTNDLENBQVY7QUFDQUEsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLEdBQWdCRCxPQUFPLENBQUNDLEtBQVIsSUFBaUIsRUFBakM7QUFDQUQsSUFBQUEsT0FBTyxDQUFDRSxNQUFSLEdBQWlCRixPQUFPLENBQUNFLE1BQVIsSUFBa0IsRUFBbkM7QUFDQUYsSUFBQUEsT0FBTyxDQUFDRyxhQUFSLEdBQXdCSCxPQUFPLENBQUNHLGFBQVIsSUFBeUIsRUFBakQ7QUFDQUgsSUFBQUEsT0FBTyxDQUFDSSxjQUFSLEdBQXlCSixPQUFPLENBQUNJLGNBQVIsSUFBMEIsRUFB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QU5BLE1BSHNCO0FBSXRCQyxNQUFBQSxNQUFNLEVBQU5BLE1BSnNCO0FBS3RCQyxNQUFBQSxjQUFjLEVBQWRBO0FBTHNCLEtBQTFCOztBQVFBLFFBQUlWLGlCQUFpQixDQUFDOEIsYUFBdEIsRUFBcUM7QUFDakMsVUFBTUMsT0FBTyxHQUFHLENBQUM3QixTQUFTLEdBQUcsQ0FBYixLQUFtQkQsU0FBUyxHQUFHLENBQS9CLENBQWhCO0FBQ0EsVUFBTStCLE9BQU8sR0FBRyxJQUFJQyxLQUFKLENBQWtCLElBQUlGLE9BQXRCLENBQWhCO0FBQ0FGLE1BQUFBLE1BQU0sQ0FBQ0csT0FBUCxHQUFpQkEsT0FBakI7O0FBQ0EsV0FBSyxJQUFJRSxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSCxPQUFwQixFQUE2QixFQUFFRyxDQUEvQixFQUFrQztBQUM5QkYsUUFBQUEsT0FBTyxDQUFDRSxDQUFDLEdBQUcsQ0FBSixHQUFRLENBQVQsQ0FBUCxHQUFxQixDQUFyQjtBQUNBRixRQUFBQSxPQUFPLENBQUNFLENBQUMsR0FBRyxDQUFKLEdBQVEsQ0FBVCxDQUFQLEdBQXFCLENBQXJCO0FBQ0FGLFFBQUFBLE9BQU8sQ0FBQ0UsQ0FBQyxHQUFHLENBQUosR0FBUSxDQUFULENBQVAsR0FBcUIsQ0FBckI7QUFDSDtBQUNKOztBQUVELFFBQUlsQyxpQkFBaUIsQ0FBQ3VCLFNBQXRCLEVBQWlDO0FBQzdCTSxNQUFBQSxNQUFNLENBQUN2QixHQUFQLEdBQWFBLEdBQWI7QUFDSDs7QUFFRCxXQUFPdUIsTUFBUDtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBjYXRlZ29yeSAzZC9wcmltaXRpdmVcclxuICovXHJcblxyXG5pbXBvcnQgeyBWZWMzIH0gZnJvbSAnLi4vbWF0aCc7XHJcbmltcG9ydCB7IGFwcGx5RGVmYXVsdEdlb21ldHJ5T3B0aW9ucywgSUdlb21ldHJ5LCBJR2VvbWV0cnlPcHRpb25zIH0gZnJvbSAnLi9kZWZpbmUnO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBUaGUgZGVmaW5pdGlvbiBvZiB0aGUgcGFyYW1ldGVyIGZvciBidWlsZGluZyBhIHBsYW5lLlxyXG4gKiBAemhcclxuICog5bmz6Z2i5Y+C5pWw6YCJ6aG544CCXHJcbiAqL1xyXG5pbnRlcmZhY2UgSVBsYW5lT3B0aW9ucyBleHRlbmRzIFJlY3Vyc2l2ZVBhcnRpYWw8SUdlb21ldHJ5T3B0aW9ucz4ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBQbGFuZSBleHRlbnQgb24gWC1heGlzLlxyXG4gICAgICovXHJcbiAgICB3aWR0aDogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUGxhbmUgZXh0ZW50IG9uIFotYXhpcy5cclxuICAgICAqL1xyXG4gICAgbGVuZ3RoOiBudW1iZXI7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZWdtZW50IGNvdW50IG9uIFgtYXhpcy5cclxuICAgICAqL1xyXG4gICAgd2lkdGhTZWdtZW50czogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2VnbWVudCBjb3VudCBvbiBaLWF4aXMuXHJcbiAgICAgKi9cclxuICAgIGxlbmd0aFNlZ21lbnRzOiBudW1iZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAemhcclxuICog5bqU55So6buY6K6k55qE5bmz6Z2i5Y+C5pWw6YCJ6aG544CCXHJcbiAqIEBwYXJhbSBvcHRpb25zIOW5s+mdouWPguaVsOmAiemhueOAglxyXG4gKi9cclxuZnVuY3Rpb24gYXBwbHlEZWZhdWx0UGxhbmVPcHRpb25zIChvcHRpb25zPzogUmVjdXJzaXZlUGFydGlhbDxJUGxhbmVPcHRpb25zPik6IElQbGFuZU9wdGlvbnMge1xyXG4gICAgb3B0aW9ucyA9IGFwcGx5RGVmYXVsdEdlb21ldHJ5T3B0aW9uczxJUGxhbmVPcHRpb25zPihvcHRpb25zKTtcclxuICAgIG9wdGlvbnMud2lkdGggPSBvcHRpb25zLndpZHRoIHx8IDEwO1xyXG4gICAgb3B0aW9ucy5sZW5ndGggPSBvcHRpb25zLmxlbmd0aCB8fCAxMDtcclxuICAgIG9wdGlvbnMud2lkdGhTZWdtZW50cyA9IG9wdGlvbnMud2lkdGhTZWdtZW50cyB8fCAxMDtcclxuICAgIG9wdGlvbnMubGVuZ3RoU2VnbWVudHMgPSBvcHRpb25zLmxlbmd0aFNlZ21lbnRzIHx8IDEwO1xyXG4gICAgcmV0dXJuIG9wdGlvbnMgYXMgSVBsYW5lT3B0aW9ucztcclxufVxyXG5cclxuY29uc3QgdGVtcDEgPSBuZXcgVmVjMygwLCAwLCAwKTtcclxuY29uc3QgdGVtcDIgPSBuZXcgVmVjMygwLCAwLCAwKTtcclxuY29uc3QgdGVtcDMgPSBuZXcgVmVjMygwLCAwLCAwKTtcclxuY29uc3QgciA9IG5ldyBWZWMzKDAsIDAsIDApO1xyXG5jb25zdCBjMDAgPSBuZXcgVmVjMygwLCAwLCAwKTtcclxuY29uc3QgYzEwID0gbmV3IFZlYzMoMCwgMCwgMCk7XHJcbmNvbnN0IGMwMSA9IG5ldyBWZWMzKDAsIDAsIDApO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBUaGlzIGZ1bmN0aW9uIGdlbmVyYXRlcyBhIHBsYW5lIG9uIFhPWiBwbGFuZSB3aXRoIHBvc2l0aXZlIFkgZGlyZWN0aW9uLlxyXG4gKiBAemhcclxuICog55Sf5oiQ5LiA5Liq5bmz6Z2i77yM5YW25L2N5LqOWE9a5bmz6Z2i77yM5pa55ZCR5Li6Wei9tOato+aWueWQkeOAglxyXG4gKiBAcGFyYW0gb3B0aW9ucyDlubPpnaLlj4LmlbDpgInpobnjgIJcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHBsYW5lIChvcHRpb25zPzogSVBsYW5lT3B0aW9ucyk6IElHZW9tZXRyeSB7XHJcbiAgICBjb25zdCBub3JtYWxpemVkT3B0aW9ucyA9IGFwcGx5RGVmYXVsdFBsYW5lT3B0aW9ucyhvcHRpb25zKTtcclxuXHJcbiAgICBjb25zdCB7XHJcbiAgICAgICAgd2lkdGgsXHJcbiAgICAgICAgbGVuZ3RoLFxyXG4gICAgICAgIHdpZHRoU2VnbWVudHM6IHVTZWdtZW50cyxcclxuICAgICAgICBsZW5ndGhTZWdtZW50czogdlNlZ21lbnRzLFxyXG4gICAgfSA9IG5vcm1hbGl6ZWRPcHRpb25zO1xyXG5cclxuICAgIGNvbnN0IGh3ID0gd2lkdGggKiAwLjU7XHJcbiAgICBjb25zdCBobCA9IGxlbmd0aCAqIDAuNTtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbnM6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdCB1dnM6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdCBpbmRpY2VzOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgY29uc3QgbWluUG9zID0gbmV3IFZlYzMoLWh3LCAwLCAtaGwpO1xyXG4gICAgY29uc3QgbWF4UG9zID0gbmV3IFZlYzMoaHcsIDAsIGhsKTtcclxuICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzID0gTWF0aC5zcXJ0KHdpZHRoICogd2lkdGggKyBsZW5ndGggKiBsZW5ndGgpO1xyXG5cclxuICAgIFZlYzMuc2V0KGMwMCwgLWh3LCAwLCBobCk7XHJcbiAgICBWZWMzLnNldChjMTAsIGh3LCAwLCBobCk7XHJcbiAgICBWZWMzLnNldChjMDEsIC1odywgMCwgLWhsKTtcclxuXHJcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8PSB2U2VnbWVudHM7IHkrKykge1xyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDw9IHVTZWdtZW50czsgeCsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHUgPSB4IC8gdVNlZ21lbnRzO1xyXG4gICAgICAgICAgICBjb25zdCB2ID0geSAvIHZTZWdtZW50cztcclxuXHJcbiAgICAgICAgICAgIFZlYzMubGVycCh0ZW1wMSwgYzAwLCBjMTAsIHUpO1xyXG4gICAgICAgICAgICBWZWMzLmxlcnAodGVtcDIsIGMwMCwgYzAxLCB2KTtcclxuICAgICAgICAgICAgVmVjMy5zdWJ0cmFjdCh0ZW1wMywgdGVtcDIsIGMwMCk7XHJcbiAgICAgICAgICAgIFZlYzMuYWRkKHIsIHRlbXAxLCB0ZW1wMyk7XHJcblxyXG4gICAgICAgICAgICBwb3NpdGlvbnMucHVzaChyLngsIHIueSwgci56KTtcclxuICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWRPcHRpb25zLmluY2x1ZGVVVikge1xyXG4gICAgICAgICAgICAgICAgdXZzLnB1c2godSwgdik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgoeCA8IHVTZWdtZW50cykgJiYgKHkgPCB2U2VnbWVudHMpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VnMSA9IHVTZWdtZW50cyArIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0geCArIHkgKiB1c2VnMTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGIgPSB4ICsgKHkgKyAxKSAqIHVzZWcxO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9ICh4ICsgMSkgKyAoeSArIDEpICogdXNlZzE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gKHggKyAxKSArIHkgKiB1c2VnMTtcclxuXHJcbiAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgZCwgYik7XHJcbiAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2goZCwgYywgYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0OiBJR2VvbWV0cnkgPSB7XHJcbiAgICAgICAgcG9zaXRpb25zLFxyXG4gICAgICAgIGluZGljZXMsXHJcbiAgICAgICAgbWluUG9zLFxyXG4gICAgICAgIG1heFBvcyxcclxuICAgICAgICBib3VuZGluZ1JhZGl1cyxcclxuICAgIH07XHJcblxyXG4gICAgaWYgKG5vcm1hbGl6ZWRPcHRpb25zLmluY2x1ZGVOb3JtYWwpIHtcclxuICAgICAgICBjb25zdCBuVmVydGV4ID0gKHZTZWdtZW50cyArIDEpICogKHVTZWdtZW50cyArIDEpO1xyXG4gICAgICAgIGNvbnN0IG5vcm1hbHMgPSBuZXcgQXJyYXk8bnVtYmVyPigzICogblZlcnRleCk7XHJcbiAgICAgICAgcmVzdWx0Lm5vcm1hbHMgPSBub3JtYWxzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgblZlcnRleDsgKytpKSB7XHJcbiAgICAgICAgICAgIG5vcm1hbHNbaSAqIDMgKyAwXSA9IDA7XHJcbiAgICAgICAgICAgIG5vcm1hbHNbaSAqIDMgKyAxXSA9IDE7XHJcbiAgICAgICAgICAgIG5vcm1hbHNbaSAqIDMgKyAyXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChub3JtYWxpemVkT3B0aW9ucy5pbmNsdWRlVVYpIHtcclxuICAgICAgICByZXN1bHQudXZzID0gdXZzO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIl19