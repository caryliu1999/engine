(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../math/index.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../math/index.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.index);
    global.box = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _index) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.default = box;

  /**
   * @category 3d/primitive
   */

  /**
   * @en
   * This function generates a box with specified extents and centered at origin,
   * but may be repositioned through the `center` option.
   * @zh
   * 生成一个立方体，其大小是定义的范围且中心在原点。
   * @param options 参数选项。
   */
  function box(options) {
    options = options || {};
    var ws = options.widthSegments || 1;
    var hs = options.heightSegments || 1;
    var ls = options.lengthSegments || 1;
    var hw = (options.width || 1) / 2;
    var hh = (options.height || 1) / 2;
    var hl = (options.length || 1) / 2;
    var corners = [_index.Vec3.set(c0, -hw, -hh, hl), _index.Vec3.set(c1, hw, -hh, hl), _index.Vec3.set(c2, hw, hh, hl), _index.Vec3.set(c3, -hw, hh, hl), _index.Vec3.set(c4, hw, -hh, -hl), _index.Vec3.set(c5, -hw, -hh, -hl), _index.Vec3.set(c6, -hw, hh, -hl), _index.Vec3.set(c7, hw, hh, -hl)];
    var faceAxes = [[2, 3, 1], // FRONT
    [4, 5, 7], // BACK
    [7, 6, 2], // TOP
    [1, 0, 4], // BOTTOM
    [1, 4, 2], // RIGHT
    [5, 0, 6] // LEFT
    ];
    var faceNormals = [[0, 0, 1], // FRONT
    [0, 0, -1], // BACK
    [0, 1, 0], // TOP
    [0, -1, 0], // BOTTOM
    [1, 0, 0], // RIGHT
    [-1, 0, 0] // LEFT
    ];
    var faceTangents = [[-1, 0, 0, 1], // FRONT
    [-1, 0, 0, 1], // BACK
    [-1, 0, 0, 1], // TOP
    [-1, 0, 0, 1], // BOTTOM
    [0, 0, -1, 1], // RIGHT
    [0, 0, 1, 1] // LEFT
    ];
    var positions = [];
    var normals = [];
    var uvs = [];
    var tangents = [];
    var indices = [];
    var minPos = new _index.Vec3(-hw, -hh, -hl);
    var maxPos = new _index.Vec3(hw, hh, hl);
    var boundingRadius = Math.sqrt(hw * hw + hh * hh + hl * hl);

    function _buildPlane(side, uSegments, vSegments) {
      var u;
      var v;
      var ix;
      var iy;
      var offset = positions.length / 3;
      var faceAxe = faceAxes[side];
      var faceNormal = faceNormals[side];
      var faceTangent = faceTangents[side];

      for (iy = 0; iy <= vSegments; iy++) {
        for (ix = 0; ix <= uSegments; ix++) {
          u = ix / uSegments;
          v = iy / vSegments;

          _index.Vec3.lerp(temp1, corners[faceAxe[0]], corners[faceAxe[1]], u);

          _index.Vec3.lerp(temp2, corners[faceAxe[0]], corners[faceAxe[2]], v);

          _index.Vec3.subtract(temp3, temp2, corners[faceAxe[0]]);

          _index.Vec3.add(r, temp1, temp3);

          positions.push(r.x, r.y, r.z);
          normals.push(faceNormal[0], faceNormal[1], faceNormal[2]);
          uvs.push(u, v);
          tangents.push(faceTangent[0], faceTangent[1], faceTangent[2], faceTangent[3]);

          if (ix < uSegments && iy < vSegments) {
            var useg1 = uSegments + 1;
            var a = ix + iy * useg1;
            var b = ix + (iy + 1) * useg1;
            var c = ix + 1 + (iy + 1) * useg1;
            var d = ix + 1 + iy * useg1;
            indices.push(offset + a, offset + d, offset + b);
            indices.push(offset + b, offset + d, offset + c);
          }
        }
      }
    }

    _buildPlane(0, ws, hs); // FRONT


    _buildPlane(4, ls, hs); // RIGHT


    _buildPlane(1, ws, hs); // BACK


    _buildPlane(5, ls, hs); // LEFT


    _buildPlane(3, ws, ls); // BOTTOM


    _buildPlane(2, ws, ls); // TOP


    return {
      positions: positions,
      normals: normals,
      uvs: uvs,
      tangents: tangents,
      indices: indices,
      minPos: minPos,
      maxPos: maxPos,
      boundingRadius: boundingRadius
    };
  }

  var temp1 = new _index.Vec3();
  var temp2 = new _index.Vec3();
  var temp3 = new _index.Vec3();
  var r = new _index.Vec3();
  var c0 = new _index.Vec3();
  var c1 = new _index.Vec3();
  var c2 = new _index.Vec3();
  var c3 = new _index.Vec3();
  var c4 = new _index.Vec3();
  var c5 = new _index.Vec3();
  var c6 = new _index.Vec3();
  var c7 = new _index.Vec3();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImU6L2QwMDQ1MjUyMC9HaXRodWIvZW5naW5lL2NvY29zL2NvcmUvcHJpbWl0aXZlL2JveC50cyJdLCJuYW1lcyI6WyJib3giLCJvcHRpb25zIiwid3MiLCJ3aWR0aFNlZ21lbnRzIiwiaHMiLCJoZWlnaHRTZWdtZW50cyIsImxzIiwibGVuZ3RoU2VnbWVudHMiLCJodyIsIndpZHRoIiwiaGgiLCJoZWlnaHQiLCJobCIsImxlbmd0aCIsImNvcm5lcnMiLCJWZWMzIiwic2V0IiwiYzAiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImZhY2VBeGVzIiwiZmFjZU5vcm1hbHMiLCJmYWNlVGFuZ2VudHMiLCJwb3NpdGlvbnMiLCJub3JtYWxzIiwidXZzIiwidGFuZ2VudHMiLCJpbmRpY2VzIiwibWluUG9zIiwibWF4UG9zIiwiYm91bmRpbmdSYWRpdXMiLCJNYXRoIiwic3FydCIsIl9idWlsZFBsYW5lIiwic2lkZSIsInVTZWdtZW50cyIsInZTZWdtZW50cyIsInUiLCJ2IiwiaXgiLCJpeSIsIm9mZnNldCIsImZhY2VBeGUiLCJmYWNlTm9ybWFsIiwiZmFjZVRhbmdlbnQiLCJsZXJwIiwidGVtcDEiLCJ0ZW1wMiIsInN1YnRyYWN0IiwidGVtcDMiLCJhZGQiLCJyIiwicHVzaCIsIngiLCJ5IiwieiIsInVzZWcxIiwiYSIsImIiLCJjIiwiZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7OztBQStEQTs7Ozs7Ozs7QUFRZSxXQUFTQSxHQUFULENBQWNDLE9BQWQsRUFBZ0Q7QUFDM0RBLElBQUFBLE9BQU8sR0FBR0EsT0FBTyxJQUFJLEVBQXJCO0FBQ0EsUUFBTUMsRUFBRSxHQUFHRCxPQUFPLENBQUNFLGFBQVIsSUFBeUIsQ0FBcEM7QUFDQSxRQUFNQyxFQUFFLEdBQUdILE9BQU8sQ0FBQ0ksY0FBUixJQUEwQixDQUFyQztBQUNBLFFBQU1DLEVBQUUsR0FBR0wsT0FBTyxDQUFDTSxjQUFSLElBQTBCLENBQXJDO0FBRUEs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bnQiOlsiLyoqXHJcbiAqIEBjYXRlZ29yeSAzZC9wcmltaXRpdmVcclxuICovXHJcblxyXG5pbXBvcnQgeyBWZWMzIH0gZnJvbSAnLi4vbWF0aCc7XHJcbmltcG9ydCB7IElHZW9tZXRyeSwgSUdlb21ldHJ5T3B0aW9ucyB9IGZyb20gJy4vZGVmaW5lJztcclxuXHJcbi8qKlxyXG4gKiBAZW5cclxuICogVGhlIGRlZmluaXRpb24gb2YgdGhlIHBhcmFtZXRlciBmb3IgYnVpbGRpbmcgYSBib3guXHJcbiAqIEB6aFxyXG4gKiDnq4vmlrnkvZPlj4LmlbDpgInpobnjgIJcclxuICovXHJcbmludGVyZmFjZSBJQm94T3B0aW9ucyBleHRlbmRzIFJlY3Vyc2l2ZVBhcnRpYWw8SUdlb21ldHJ5T3B0aW9ucz4ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEJveCBleHRlbnQgb24gWC1heGlzLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDnq4vmlrnkvZPlrr3luqbjgIJcclxuICAgICAqL1xyXG4gICAgd2lkdGg/OiBudW1iZXI7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEJveCBleHRlbnQgb24gWS1heGlzLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDnq4vmlrnkvZPpq5jluqbjgIJcclxuICAgICAqL1xyXG4gICAgaGVpZ2h0PzogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBCb3ggZXh0ZW50IG9uIFotYXhpcy5cclxuICAgICAqIEB6aFxyXG4gICAgICog56uL5pa55L2T6ZW/5bqm44CCXHJcbiAgICAgKi9cclxuICAgIGxlbmd0aD86IG51bWJlcjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogU2VnbWVudCBjb3VudCBvbiBYLWF4aXMuXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWuveW6pue6v+auteaVsOOAglxyXG4gICAgICovXHJcbiAgICB3aWR0aFNlZ21lbnRzPzogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTZWdtZW50IGNvdW50IG9uIFktYXhpcy5cclxuICAgICAqIEB6aFxyXG4gICAgICog6auY5bqm57q/5q615pWw44CCXHJcbiAgICAgKi9cclxuICAgIGhlaWdodFNlZ21lbnRzPzogbnVtYmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTZWdtZW50IGNvdW50IG9uIFotYXhpcy5cclxuICAgICAqIEB6aFxyXG4gICAgICog6ZW/5bqm57q/5q615pWw44CCXHJcbiAgICAgKi9cclxuICAgIGxlbmd0aFNlZ21lbnRzPzogbnVtYmVyO1xyXG59XHJcblxyXG4vKipcclxuICogQGVuXHJcbiAqIFRoaXMgZnVuY3Rpb24gZ2VuZXJhdGVzIGEgYm94IHdpdGggc3BlY2lmaWVkIGV4dGVudHMgYW5kIGNlbnRlcmVkIGF0IG9yaWdpbixcclxuICogYnV0IG1heSBiZSByZXBvc2l0aW9uZWQgdGhyb3VnaCB0aGUgYGNlbnRlcmAgb3B0aW9uLlxyXG4gKiBAemhcclxuICog55Sf5oiQ5LiA5Liq56uL5pa55L2T77yM5YW25aSn5bCP5piv5a6a5LmJ55qE6IyD5Zu05LiU5Lit5b+D5Zyo5Y6f54K544CCXHJcbiAqIEBwYXJhbSBvcHRpb25zIOWPguaVsOmAiemhueOAglxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gYm94IChvcHRpb25zPzogSUJveE9wdGlvbnMpOiBJR2VvbWV0cnkge1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICBjb25zdCB3cyA9IG9wdGlvbnMud2lkdGhTZWdtZW50cyB8fCAxO1xyXG4gICAgY29uc3QgaHMgPSBvcHRpb25zLmhlaWdodFNlZ21lbnRzIHx8IDE7XHJcbiAgICBjb25zdCBscyA9IG9wdGlvbnMubGVuZ3RoU2VnbWVudHMgfHwgMTtcclxuXHJcbiAgICBjb25zdCBodyA9IChvcHRpb25zLndpZHRoIHx8IDEpIC8gMjtcclxuICAgIGNvbnN0IGhoID0gKG9wdGlvbnMuaGVpZ2h0IHx8IDEpIC8gMjtcclxuICAgIGNvbnN0IGhsID0gKG9wdGlvbnMubGVuZ3RoIHx8IDEpIC8gMjtcclxuXHJcbiAgICBjb25zdCBjb3JuZXJzID0gW1xyXG4gICAgICAgIFZlYzMuc2V0KGMwLCAtaHcsIC1oaCwgaGwpLFxyXG4gICAgICAgIFZlYzMuc2V0KGMxLCBodywgLWhoLCBobCksXHJcbiAgICAgICAgVmVjMy5zZXQoYzIsIGh3LCBoaCwgaGwpLFxyXG4gICAgICAgIFZlYzMuc2V0KGMzLCAtaHcsIGhoLCBobCksXHJcbiAgICAgICAgVmVjMy5zZXQoYzQsIGh3LCAtaGgsIC1obCksXHJcbiAgICAgICAgVmVjMy5zZXQoYzUsIC1odywgLWhoLCAtaGwpLFxyXG4gICAgICAgIFZlYzMuc2V0KGM2LCAtaHcsIGhoLCAtaGwpLFxyXG4gICAgICAgIFZlYzMuc2V0KGM3LCBodywgaGgsIC1obCksXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGZhY2VBeGVzID0gW1xyXG4gICAgICAgIFsyLCAzLCAxXSwgLy8gRlJPTlRcclxuICAgICAgICBbNCwgNSwgN10sIC8vIEJBQ0tcclxuICAgICAgICBbNywgNiwgMl0sIC8vIFRPUFxyXG4gICAgICAgIFsxLCAwLCA0XSwgLy8gQk9UVE9NXHJcbiAgICAgICAgWzEsIDQsIDJdLCAvLyBSSUdIVFxyXG4gICAgICAgIFs1LCAwLCA2XSwgIC8vIExFRlRcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZmFjZU5vcm1hbHMgPSBbXHJcbiAgICAgICAgWyAwLCAgMCwgIDFdLCAvLyBGUk9OVFxyXG4gICAgICAgIFsgMCwgIDAsIC0xXSwgLy8gQkFDS1xyXG4gICAgICAgIFsgMCwgIDEsICAwXSwgLy8gVE9QXHJcbiAgICAgICAgWyAwLCAtMSwgIDBdLCAvLyBCT1RUT01cclxuICAgICAgICBbIDEsICAwLCAgMF0sIC8vIFJJR0hUXHJcbiAgICAgICAgWy0xLCAgMCwgIDBdLCAgLy8gTEVGVFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBmYWNlVGFuZ2VudHMgPSBbXHJcbiAgICAgICAgWy0xLCAwLCAgMCwgMV0sIC8vIEZST05UXHJcbiAgICAgICAgWy0xLCAwLCAgMCwgMV0sIC8vIEJBQ0tcclxuICAgICAgICBbLTEsIDAsICAwLCAxXSwgLy8gVE9QXHJcbiAgICAgICAgWy0xLCAwLCAgMCwgMV0sIC8vIEJPVFRPTVxyXG4gICAgICAgIFsgMCwgMCwgLTEsIDFdLCAvLyBSSUdIVFxyXG4gICAgICAgIFsgMCwgMCwgIDEsIDFdLCAvLyBMRUZUXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHBvc2l0aW9uczogbnVtYmVyW10gPSBbXTtcclxuICAgIGNvbnN0IG5vcm1hbHM6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdCB1dnM6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdCB0YW5nZW50czogbnVtYmVyW10gPSBbXTtcclxuICAgIGNvbnN0IGluZGljZXM6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdCBtaW5Qb3MgPSBuZXcgVmVjMygtaHcsIC1oaCwgLWhsKTtcclxuICAgIGNvbnN0IG1heFBvcyA9IG5ldyBWZWMzKGh3LCBoaCwgaGwpO1xyXG4gICAgY29uc3QgYm91bmRpbmdSYWRpdXMgPSBNYXRoLnNxcnQoaHcgKiBodyArIGhoICogaGggKyBobCAqIGhsKTtcclxuXHJcbiAgICBmdW5jdGlvbiBfYnVpbGRQbGFuZSAoc2lkZTogbnVtYmVyLCB1U2VnbWVudHM6IG51bWJlciwgdlNlZ21lbnRzOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQgdTogbnVtYmVyO1xyXG4gICAgICAgIGxldCB2OiBudW1iZXI7XHJcbiAgICAgICAgbGV0IGl4OiBudW1iZXI7XHJcbiAgICAgICAgbGV0IGl5OiBudW1iZXI7XHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gcG9zaXRpb25zLmxlbmd0aCAvIDM7XHJcbiAgICAgICAgY29uc3QgZmFjZUF4ZSA9IGZhY2VBeGVzW3NpZGVdO1xyXG4gICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBmYWNlTm9ybWFsc1tzaWRlXTtcclxuICAgICAgICBjb25zdCBmYWNlVGFuZ2VudCA9IGZhY2VUYW5nZW50c1tzaWRlXTtcclxuXHJcbiAgICAgICAgZm9yIChpeSA9IDA7IGl5IDw9IHZTZWdtZW50czsgaXkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGl4ID0gMDsgaXggPD0gdVNlZ21lbnRzOyBpeCsrKSB7XHJcbiAgICAgICAgICAgICAgICB1ID0gaXggLyB1U2VnbWVudHM7XHJcbiAgICAgICAgICAgICAgICB2ID0gaXkgLyB2U2VnbWVudHM7XHJcblxyXG4gICAgICAgICAgICAgICAgVmVjMy5sZXJwKHRlbXAxLCBjb3JuZXJzW2ZhY2VBeGVbMF1dLCBjb3JuZXJzW2ZhY2VBeGVbMV1dLCB1KTtcclxuICAgICAgICAgICAgICAgIFZlYzMubGVycCh0ZW1wMiwgY29ybmVyc1tmYWNlQXhlWzBdXSwgY29ybmVyc1tmYWNlQXhlWzJdXSwgdik7XHJcbiAgICAgICAgICAgICAgICBWZWMzLnN1YnRyYWN0KHRlbXAzLCB0ZW1wMiwgY29ybmVyc1tmYWNlQXhlWzBdXSk7XHJcbiAgICAgICAgICAgICAgICBWZWMzLmFkZChyLCB0ZW1wMSwgdGVtcDMpO1xyXG5cclxuICAgICAgICAgICAgICAgIHBvc2l0aW9ucy5wdXNoKHIueCwgci55LCByLnopO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFscy5wdXNoKGZhY2VOb3JtYWxbMF0sIGZhY2VOb3JtYWxbMV0sIGZhY2VOb3JtYWxbMl0pO1xyXG4gICAgICAgICAgICAgICAgdXZzLnB1c2godSwgdik7XHJcbiAgICAgICAgICAgICAgICB0YW5nZW50cy5wdXNoKGZhY2VUYW5nZW50WzBdLCBmYWNlVGFuZ2VudFsxXSwgZmFjZVRhbmdlbnRbMl0sIGZhY2VUYW5nZW50WzNdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoKGl4IDwgdVNlZ21lbnRzKSAmJiAoaXkgPCB2U2VnbWVudHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlZzEgPSB1U2VnbWVudHMgKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBpeCArIGl5ICogdXNlZzE7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYiA9IGl4ICsgKGl5ICsgMSkgKiB1c2VnMTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gKGl4ICsgMSkgKyAoaXkgKyAxKSAqIHVzZWcxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSAoaXggKyAxKSArIGl5ICogdXNlZzE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGluZGljZXMucHVzaChvZmZzZXQgKyBhLCBvZmZzZXQgKyBkLCBvZmZzZXQgKyBiKTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2gob2Zmc2V0ICsgYiwgb2Zmc2V0ICsgZCwgb2Zmc2V0ICsgYyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2J1aWxkUGxhbmUoMCwgd3MsIGhzKTsgLy8gRlJPTlRcclxuICAgIF9idWlsZFBsYW5lKDQsIGxzLCBocyk7IC8vIFJJR0hUXHJcbiAgICBfYnVpbGRQbGFuZSgxLCB3cywgaHMpOyAvLyBCQUNLXHJcbiAgICBfYnVpbGRQbGFuZSg1LCBscywgaHMpOyAvLyBMRUZUXHJcbiAgICBfYnVpbGRQbGFuZSgzLCB3cywgbHMpOyAvLyBCT1RUT01cclxuICAgIF9idWlsZFBsYW5lKDIsIHdzLCBscyk7IC8vIFRPUFxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcG9zaXRpb25zLFxyXG4gICAgICAgIG5vcm1hbHMsXHJcbiAgICAgICAgdXZzLFxyXG4gICAgICAgIHRhbmdlbnRzLFxyXG4gICAgICAgIGluZGljZXMsXHJcbiAgICAgICAgbWluUG9zLFxyXG4gICAgICAgIG1heFBvcyxcclxuICAgICAgICBib3VuZGluZ1JhZGl1cyxcclxuICAgIH07XHJcbn1cclxuXHJcbmNvbnN0IHRlbXAxID0gbmV3IFZlYzMoKTtcclxuY29uc3QgdGVtcDIgPSBuZXcgVmVjMygpO1xyXG5jb25zdCB0ZW1wMyA9IG5ldyBWZWMzKCk7XHJcbmNvbnN0IHIgPSBuZXcgVmVjMygpO1xyXG5jb25zdCBjMCA9IG5ldyBWZWMzKCk7XHJcbmNvbnN0IGMxID0gbmV3IFZlYzMoKTtcclxuY29uc3QgYzIgPSBuZXcgVmVjMygpO1xyXG5jb25zdCBjMyA9IG5ldyBWZWMzKCk7XHJcbmNvbnN0IGM0ID0gbmV3IFZlYzMoKTtcclxuY29uc3QgYzUgPSBuZXcgVmVjMygpO1xyXG5jb25zdCBjNiA9IG5ldyBWZWMzKCk7XHJcbmNvbnN0IGM3ID0gbmV3IFZlYzMoKTtcclxuIl19